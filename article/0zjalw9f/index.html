<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.19" /><meta name="theme" content="VuePress Theme Plume " /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><meta property="og:url" content="https://lostyouth.github.io/article/0zjalw9f/"><meta property="og:site_name" content="Dylan's Blog"><meta property="og:title" content="deepseek-r1-14B的安装和应用"><meta property="og:description" content="安装Ollama Ollama 是一个基于 Go 语言开发的本地大语言模型运行框架，类似于 Docker 的操作方式，支持多种预训练模型（如 DeepSeek、LLaMA 2、Mistral 等），并提供便捷的本地实验和 AI 应用开发环境。 Ollama 的主要功能 本地模型管理：支持从官方模型库或自定义模型库拉取预训练模型，并在本地保存和加载 高效..."><meta property="og:type" content="article"><meta property="og:image" content="https://blog-1306791249.cos.ap-guangzhou.myqcloud.com/ollama-deepseek-r1-option.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-03-04T01:11:30.000Z"><meta property="article:tag" content="大模型"><meta property="article:modified_time" content="2025-03-04T01:11:30.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"deepseek-r1-14B的安装和应用","image":["https://blog-1306791249.cos.ap-guangzhou.myqcloud.com/ollama-deepseek-r1-option.png"],"dateModified":"2025-03-04T01:11:30.000Z","author":[]}</script><link rel="icon" type="image/svg" href="/logo.svg"><title>deepseek-r1-14B的安装和应用 | Dylan's Blog</title><meta name="description" content="安装Ollama Ollama 是一个基于 Go 语言开发的本地大语言模型运行框架，类似于 Docker 的操作方式，支持多种预训练模型（如 DeepSeek、LLaMA 2、Mistral 等），并提供便捷的本地实验和 AI 应用开发环境。 Ollama 的主要功能 本地模型管理：支持从官方模型库或自定义模型库拉取预训练模型，并在本地保存和加载 高效..."><link rel="preload" href="/assets/style-DZT0U1xV.css" as="style"><link rel="stylesheet" href="/assets/style-DZT0U1xV.css"><link rel="modulepreload" href="/assets/app-BuKB4cl4.js"><link rel="modulepreload" href="/assets/index.html-DkhjtyUa.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-052770ec><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-6e4caad3></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-6e4caad3> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-052770ec data-v-690031e7><div class="vp-navbar" vp-navbar data-v-690031e7 data-v-4442ed38><div class="wrapper" data-v-4442ed38><div class="container" data-v-4442ed38><div class="title" data-v-4442ed38><div class="vp-navbar-title" data-v-4442ed38 data-v-67fec3f3><a class="vp-link no-icon link title" href="/" data-v-67fec3f3 data-v-5aedb7f3><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" src="/logo.svg" alt data-v-2dedf5ec><!--]--><!--[--><img class="vp-image light logo" src="/logo.svg" alt data-v-2dedf5ec><!--]--><!--]--><!--]--><span data-v-67fec3f3>Dylan&#39;s Blog</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-4442ed38><div class="content-body" data-v-4442ed38><!--[--><!--]--><div class="vp-navbar-search search" data-v-4442ed38><div class="search-wrapper" data-v-c650bd12><!----><div id="local-search" data-v-c650bd12><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-c650bd12><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-4442ed38 data-v-d5b7bad3><span id="main-nav-aria-label" class="visually-hidden" data-v-d5b7bad3>Main Navigation</span><!--[--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/" tabindex="0" data-v-d5b7bad3 data-v-8d7a14e7 data-v-5aedb7f3><!--[--><!----><span data-v-8d7a14e7>首页</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/blog/" tabindex="0" data-v-d5b7bad3 data-v-8d7a14e7 data-v-5aedb7f3><!--[--><!----><span data-v-8d7a14e7>博客</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/blog/tags/" tabindex="0" data-v-d5b7bad3 data-v-8d7a14e7 data-v-5aedb7f3><!--[--><!----><span data-v-8d7a14e7>标签</span><!--]--><!----></a><!--]--><!--]--></nav><!----><div class="vp-navbar-appearance appearance" data-v-4442ed38 data-v-eb7e5c29><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-eb7e5c29 data-v-f0ba9f54 data-v-4e2473ff><span class="check" data-v-4e2473ff><span class="icon" data-v-4e2473ff><!--[--><span class="vpi-sun sun" data-v-f0ba9f54></span><span class="vpi-moon moon" data-v-f0ba9f54></span><!--]--></span></span></button></div><!----><div class="vp-flyout vp-navbar-extra extra" data-v-4442ed38 data-v-55cc1807 data-v-87e62099><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-87e62099><span class="vpi-more-horizontal icon" data-v-87e62099></span></button><div class="menu" data-v-87e62099><div class="vp-menu" data-v-87e62099 data-v-23076671><!----><!--[--><!--[--><!----><div class="group" data-v-55cc1807><div class="item appearance" data-v-55cc1807><p class="label" data-v-55cc1807>外观</p><div class="appearance-action" data-v-55cc1807><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-55cc1807 data-v-f0ba9f54 data-v-4e2473ff><span class="check" data-v-4e2473ff><span class="icon" data-v-4e2473ff><!--[--><span class="vpi-sun sun" data-v-f0ba9f54></span><span class="vpi-moon moon" data-v-f0ba9f54></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-4442ed38 data-v-faa9a7d3><span class="container" data-v-faa9a7d3><span class="top" data-v-faa9a7d3></span><span class="middle" data-v-faa9a7d3></span><span class="bottom" data-v-faa9a7d3></span></span></button></div></div></div></div><div class="divider" data-v-4442ed38><div class="divider-line" data-v-4442ed38></div></div></div><!----></header><div class="vp-local-nav fixed reached-top is-blog" data-v-052770ec data-v-36a87ea9><button class="hidden menu" disabled aria-expanded="false" aria-controls="SidebarNav" data-v-36a87ea9><span class="vpi-align-left menu-icon" data-v-36a87ea9></span><span class="menu-text" data-v-36a87ea9>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-36a87ea9 data-v-4196cf89><button data-v-4196cf89>返回顶部</button><!----></div></div><!----><!--[--><div id="VPContent" vp-content class="vp-content" data-v-052770ec data-v-37f60272><div class="vp-doc-container is-blog" data-v-37f60272 data-v-5e41a7a3><!--[--><!--]--><div class="container" data-v-5e41a7a3><!----><div class="content" data-v-5e41a7a3><div class="content-container" data-v-5e41a7a3><!--[--><!--]--><main class="main" data-v-5e41a7a3><!----><!--[--><h1 class="vp-doc-title page-title" data-v-c5642e1c>deepseek-r1-14B的安装和应用 <!----></h1><div class="vp-doc-meta" data-v-c5642e1c><p class="reading-time" data-v-c5642e1c><span class="vpi-books icon" data-v-c5642e1c></span><span data-v-c5642e1c>约 1967 字</span><span data-v-c5642e1c>大约 7 分钟</span></p><p data-v-c5642e1c><span class="vpi-tag icon" data-v-c5642e1c></span><!--[--><a class="vp-link no-icon link tag vp-tag-8rv4" href="/blog/tags/?tag=大模型" data-v-c5642e1c data-v-5aedb7f3><!--[-->大模型<!--]--><!----></a><!--]--></p><p class="create-time" data-v-c5642e1c><span class="vpi-clock icon" data-v-c5642e1c></span><span data-v-c5642e1c>2025-02-21</span></p></div><!--]--><div class="_article_0zjalw9f_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-5e41a7a3><div data-v-5e41a7a3><h2 id="安装ollama" tabindex="-1"><a class="header-anchor" href="#安装ollama"><span>安装Ollama</span></a></h2><p>Ollama 是一个基于 Go 语言开发的本地大语言模型运行框架，类似于 Docker 的操作方式，支持多种预训练模型（如 DeepSeek、LLaMA 2、Mistral 等），并提供便捷的本地实验和 AI 应用开发环境。</p><h3 id="ollama-的主要功能" tabindex="-1"><a class="header-anchor" href="#ollama-的主要功能"><span>Ollama 的主要功能</span></a></h3><ol><li>本地模型管理：支持从官方模型库或自定义模型库拉取预训练模型，并在本地保存和加载</li><li>高效推理：通过 GPU/CPU 加速，提供高效的模型推理能力</li><li>多种接口访问：支持命令行（CLI）、HTTP 接口访问推理服务，并通过 OpenAI 客户端实现更广泛的集成</li><li>模型微调与自定义：用户可以基于预训练模型进行微调，满足特定需求</li><li>跨平台支持：支持 macOS、Linux 和 Windows 等主流操作系统</li></ol><h3 id="ollama-的特点" tabindex="-1"><a class="header-anchor" href="#ollama-的特点"><span>Ollama 的特点</span></a></h3><ol><li>简化部署：简化了在本地计算机上运行和部署大型语言模型的流程</li><li>轻量级与可扩展：保持较小的资源占用，同时具备良好的可扩展性</li><li>API 支持：提供简洁的 API，方便开发者创建、运行和管理模型实例</li><li>预构建模型库：包含一系列预先训练好的模型，用户可以直接选用</li><li>数据隐私：支持本地运行，无需依赖云端，确保数据隐私</li></ol><h3 id="ollama-的安装与使用" tabindex="-1"><a class="header-anchor" href="#ollama-的安装与使用"><span>Ollama 的安装与使用</span></a></h3><p>使用一键安装脚本</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-fsSL</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://ollama.ai/install.sh</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>实际过程中由于脚本是去github下载安装包，由于网速原因改为手动下载了安装包，并把安装脚本修改为安装本地安装包。</p><h3 id="模型的选择" tabindex="-1"><a class="header-anchor" href="#模型的选择"><span>模型的选择</span></a></h3><p>下载并运行模型，运行多大的模型取决于显卡显存的大小，一般预估模型占用显存的大小可以根据模型的体积判断，本地服务器显卡为A4500 20G显存，所以选择了14B的模型。</p><p>由于deepseek-r1模型6710亿的参数，需要400+的显存空间才能运行，难以在本地服务器运行。14B的模型其实不是deepseek本模型，而是使用蒸馏技术把deepseek-r1的能力蒸馏到千问14B的模型上。14B的模型也是经过4比特量化过的。</p><p><img src="https://blog-1306791249.cos.ap-guangzhou.myqcloud.com/ollama-deepseek-r1-option.png" alt="ollama-deepseek-r1"></p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ollama</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">run</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">deepseek-r1:14b</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>模型下载到最后可能会遇到下载速度变慢的情况，可以按ctrl+c暂停下载，暂停后下载进度是保留的，然后执行命令重新下载，此时下载速度会变快。</p><p>执行Ollama run以后就可以在命令框中直接和大模型对话了。Ollama也提供了server命令，可以提供本地api服务供其他应用调用。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ollama</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Ollama运行服务后，可以安装webui去访问api。本次选择https://github.com/ollama-webui/ollama-webui-lite 作为webui。ollama-webui-lite采用sevlte框架开发。部署完可通过http://ollama-webui.example.com/ 访问。</p><p>需要注意的是，由于Ollama server服务似乎对api/chat接口有特殊限制所以nginx的配置需要调整，特别是以下几行：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">proxy_buffering</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">off</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">proxy_set_header</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Origin</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">proxy_set_header</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Referer</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>另外由于Ollama对接口调用并不会进行鉴权操作，应该对不必要的接口禁止访问，只允许api/chat等接口的访问。还要对api/chat接口进行限流，防止接口被恶意调用。</p><p>完整配置如下：</p><div class="language-nginx line-numbers-mode" data-ext="nginx" data-title="nginx"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">map</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">http_upgrade</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">connection_upgrade</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">default</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">upgrade</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;&#39;</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">close</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">定义限流区域</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">limit_req_zone</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">binary_remote_addr</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">zone=api_limit:1m</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">rate=1r/s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">server</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">server_name</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ollama-webui.example.com</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">client_max_body_size</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">10M</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">fastcgi_buffers</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">8</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4K</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">fastcgi_buffer_size</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4K</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">client_body_buffer_size</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1024k</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">root</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/home1/ollama/webui</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">index</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">index.html</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">location</span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">try_files</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">uri</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">uri</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/index.html</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">index</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">index.html</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">request_filename</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">~*</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.*\.html$)</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">add_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Cache-Control</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;no-store&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">location</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">~*</span><span class="space"> </span><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">/api/(tags|version|chat|generate)</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">proxy_http_version</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1.1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">proxy_buffering</span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">off</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">proxy_set_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Origin</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">proxy_set_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Referer</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">request_method</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;OPTIONS&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">add_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Access-Control-Allow-Origin</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">*</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">add_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Access-Control-Allow-Methods</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">GET,POST,PUT,DELETE,OPTIONS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">add_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Access-Control-Allow-Headers</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">X-Requested-With,Content-Type,Authorization</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">return</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">204</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">request_method</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!=</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;OPTIONS&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">add_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Access-Control-Allow-Origin</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">*</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">add_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Access-Control-Allow-Methods</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">GET,POST,PUT,DELETE,OPTIONS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">add_header</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Access-Control-Allow-Headers</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">X-Requested-With,Content-Type,Authorization</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">proxy_pass</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">http://127.0.0.1:11434</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">应用限流规则</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">limit_req</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">zone=api_limit</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">burst=2</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">nodelay</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">location</span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/api/</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">return</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">404</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">location</span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">@router</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">rewrite</span><span class="space"> </span><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">^.*$</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/index.html</span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">last</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">error_page</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">500</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">502</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">503</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">504</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/50x.html</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">location</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span class="space"> </span><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">/50x.html</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">root</span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">html</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用" tabindex="-1"><a class="header-anchor" href="#使用"><span>使用</span></a></h2><p>为了探索模型在系统中的使用，尝试使用deepseek结构化输出的提示词，使用自然语言匹配预先配置好的指令，来快速操作系统。</p><p>生成指令列表以及其他规则的提示词。</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>你现在是一个系统助手，以下是定义好的的指令，定义好的指令格式为“指令名称:</span><span class="space"> </span><span>指令解释”</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>GEN_DAY_REPORT:</span><span class="space"> </span><span>生成日报表</span></span>
<span class="line"><span>GEN_MONTH_REPROT:</span><span class="space"> </span><span>生成月报表</span></span>
<span class="line"><span>GEN_YEAR_REPORT:</span><span class="space"> </span><span>生成年报表</span></span>
<span class="line"><span>SUMMARY_EMPLOYEE_LIST:</span><span class="space"> </span><span>查询员工列表</span></span>
<span class="line"><span>SUMMARY_EMPLOYEE_DETAIL:</span><span class="space"> </span><span>查询员工详情</span></span>
<span class="line"><span>SUMMARY_DEPT:</span><span class="space"> </span><span>查询部门</span></span>
<span class="line"><span></span></span>
<span class="line"><span>可能涉及到的查询条件对应的英文:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>开始时间:</span><span class="space"> </span><span>startDate</span></span>
<span class="line"><span>结束时间:</span><span class="space"> </span><span>endDate</span></span>
<span class="line"><span>部门:</span><span class="space"> </span><span>deptName</span></span>
<span class="line"><span>时间:</span><span class="space"> </span><span>date</span></span>
<span class="line"><span>员工名称:</span><span class="space"> </span><span>employeeName</span></span>
<span class="line"><span></span></span>
<span class="line"><span>如果参数涉及到了时间，时间的格式参考:2025-02-07</span><span class="space"> </span><span>14:38:01</span></span>
<span class="line"><span></span></span>
<span class="line"><span>需要根据用户的输入匹配系统提前定义好的指令，不要思考过程，只返回如下的结构</span></span>
<span class="line"><span></span></span>
<span class="line"><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;task&quot;:</span><span class="space"> </span><span>&lt;指令名称&gt;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;desc&quot;:</span><span class="space"> </span><span>&lt;指令解释&gt;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;params&quot;:</span><span class="space"> </span><span>&lt;查询条件&gt;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>如果没有匹配到任何指令，不要思考过程，只返回</span></span>
<span class="line"><span></span></span>
<span class="line"><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;task&quot;:</span><span class="space"> </span><span>&quot;NOT_FOUND&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;desc&quot;:</span><span class="space"> </span><span>&quot;404&quot;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过接口调用 http://ollama-webui.example.com/api/chat 测试用例：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;model&quot;:</span><span class="space"> </span><span>&quot;deepseek-r1:14b&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;messages&quot;:</span><span class="space"> </span><span>[</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;role&quot;:</span><span class="space"> </span><span>&quot;user&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;content&quot;:</span><span class="space"> </span><span>&quot;请直接给出结果，不要思考过程：[帮我查询明天的天气]&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;role&quot;:</span><span class="space"> </span><span>&quot;system&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;content&quot;:</span><span class="space"> </span><span>&quot;你现在是一个系统助手，以下是定义好的的指令，定义好的指令格式为“指令名称:</span><span class="space"> </span><span>指令解释”\n\n\nGEN_DAY_REPORT:</span><span class="space"> </span><span>生成日报表\nGEN_MONTH_REPROT:</span><span class="space"> </span><span>生成月报表\nGEN_YEAR_REPORT:</span><span class="space"> </span><span>生成年报表\nSUMMARY_EMPLOYEE_LIST:</span><span class="space"> </span><span>查询员工列表\nSUMMARY_EMPLOYEE_DETAIL:</span><span class="space"> </span><span>查询员工详情\nSUMMARY_DEPT:</span><span class="space"> </span><span>查询部门\n\n可能涉及到的查询条件对应的英文:\n\n开始时间:</span><span class="space"> </span><span>startDate\n结束时间:</span><span class="space"> </span><span>endDate\n部门:</span><span class="space"> </span><span>deptName\n时间:</span><span class="space"> </span><span>date\n员工名称:</span><span class="space"> </span><span>employeeName\n\n如果参数涉及到了时间，时间的格式参考2025-02-07</span><span class="space"> </span><span>14:38:01\n\n需要根据用户的输入匹配系统提前定义好的指令，不要思考过程，只返回如下的结构\n\n{\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;task\&quot;:</span><span class="space"> </span><span>&lt;指令名称&gt;,\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;desc\&quot;:</span><span class="space"> </span><span>&lt;指令解释&gt;,\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;params\&quot;:</span><span class="space"> </span><span>&lt;查询条件&gt;\n}\n\n如果没有匹配到任何指令，不要思考过程，只返回\n\n{\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;task\&quot;:</span><span class="space"> </span><span>\&quot;NOT_FOUND\&quot;,\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;desc\&quot;:</span><span class="space"> </span><span>\&quot;404\&quot;\n}&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>],</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;options&quot;:</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;temperature&quot;:</span><span class="space"> </span><span>0.1,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;top_p&quot;:</span><span class="space"> </span><span>0.1</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;stream&quot;:</span><span class="space"> </span><span>false</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的请求尝试多次均可以准确匹配命令，但是还需要大规模数据的验证。<!---->标签中返回的是模型的思考过程，模型思考结束直接返回固定的json结构数据，可交给系统继续处理。</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;model&quot;:</span><span class="space"> </span><span>&quot;deepseek-r1:14b&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;created_at&quot;:</span><span class="space"> </span><span>&quot;2025-02-08T06:23:35.196878118Z&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;message&quot;:</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;role&quot;:</span><span class="space"> </span><span>&quot;system&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;content&quot;:</span><span class="space"> </span><span>&quot;&lt;/think&gt;\n好，我现在需要处理用户的查询：“查询2024年1月2号的日报”。首先，我要分析这个请求属于哪个指令。用户提到了“日报”，这可能对应生成日报表的任务。\n\n接下来，查看定义好的指令列表，GEN_DAY_REPORT</span><span class="space"> </span><span>是生成日报表的指令，符合用户的需求。因此，任务应该是</span><span class="space"> </span><span>GEN_DAY_REPORT。\n\n然后，确定参数部分。用户明确指定了日期是2024年1月2号，所以需要将这个日期作为查询条件。根据格式要求，时间参数需要用</span><span class="space"> </span><span>YYYY-MM-DD</span><span class="space"> </span><span>格式，这里正好匹配。\n\n最后，构建响应结构，包含</span><span class="space"> </span><span>task、desc</span><span class="space"> </span><span>和</span><span class="space"> </span><span>params</span><span class="space"> </span><span>三个字段。task</span><span class="space"> </span><span>设为</span><span class="space"> </span><span>GEN_DAY_REPORT，desc</span><span class="space"> </span><span>是生成日报表的解释，params</span><span class="space"> </span><span>包含</span><span class="space"> </span><span>date</span><span class="space"> </span><span>参数设置为指定日期。\n&lt;/think&gt;\n\n```json\n{\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;task\&quot;:</span><span class="space"> </span><span>\&quot;GEN_DAY_REPORT\&quot;,\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;desc\&quot;:</span><span class="space"> </span><span>\&quot;生成日报表\&quot;,\n</span><span class="space"> </span><span class="space"> </span><span>\&quot;params\&quot;:</span><span class="space"> </span><span>{\n</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>\&quot;date\&quot;:</span><span class="space"> </span><span>\&quot;2024-01-02\&quot;\n</span><span class="space"> </span><span class="space"> </span><span>}\n}\n```&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;done_reason&quot;:</span><span class="space"> </span><span>&quot;stop&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;done&quot;:</span><span class="space"> </span><span>true,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;total_duration&quot;:</span><span class="space"> </span><span>5348766404,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;load_duration&quot;:</span><span class="space"> </span><span>8896988,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;prompt_eval_count&quot;:</span><span class="space"> </span><span>252,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;prompt_eval_duration&quot;:</span><span class="space"> </span><span>96000000,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;eval_count&quot;:</span><span class="space"> </span><span>218,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;eval_duration&quot;:</span><span class="space"> </span><span>5240000000</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-5e41a7a3 data-v-1c2bcfa4><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-1c2bcfa4><span class="contributors-label" data-v-1c2bcfa4>贡献者: </span><span class="contributors-info" data-v-1c2bcfa4><!--[--><!--[--><span class="contributor" data-v-1c2bcfa4>chenyang</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-1c2bcfa4><div class="pager" data-v-1c2bcfa4><!----></div><div class="pager" data-v-1c2bcfa4><a class="vp-link no-icon link pager-link next" href="/article/jw8aizl2/" data-v-1c2bcfa4 data-v-5aedb7f3><!--[--><span class="desc" data-v-1c2bcfa4>下一页</span><span class="title" data-v-1c2bcfa4>frp内网穿透</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-052770ec data-v-4e8915fc><span class="percent" data-allow-mismatch data-v-4e8915fc>0%</span><span class="show icon vpi-back-to-top" data-v-4e8915fc></span><svg aria-hidden="true" data-v-4e8915fc><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-4e8915fc></circle></svg></button><footer class="vp-footer" vp-footer data-v-052770ec data-v-f4d7032a><!--[--><div class="container" data-v-f4d7032a><p class="message" data-v-f4d7032a>Power by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-BuKB4cl4.js" defer></script></body></html>